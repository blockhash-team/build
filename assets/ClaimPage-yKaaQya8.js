import{ag as s,ah as S,ai as U,aj as N,ak as O,al as E,am as t,$ as e,an as J,ao as k,ap as h,a1 as L}from"./index-iRHCKbQM.js";import{P as R}from"./Page-00w8ALOG.js";import{s as I,f as F}from"./formattingUtils-7q9r0_k3.js";const P=c=>{const[m,b]=s.useState({index:0,amount:"",proof:[]}),{isConnected:f,address:n}=S();let x="",i="";c=="juice"?(x="mainnet",i="https://juice.blockhashgg.workers.dev"):c=="xjuice"&&(x="mainnet",i="https://xjuice.blockhashgg.workers.dev");const g=s.useCallback(async()=>{if(f)try{const l=await(await fetch(i,{body:JSON.stringify({key:`${x}:${n}`}),headers:{"Content-Type":"application/json","Referrer-Policy":"no-referrer"},method:"POST"})).json();b(l)}catch{b({index:0,amount:"0",proof:[]})}},[f,n]);return s.useEffect(()=>{g()},[f,n,g]),m},K=P,j=[{inputs:[{internalType:"address",name:"token_",type:"address"},{internalType:"bytes32",name:"merkleRoot_",type:"bytes32"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Claimed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"merkleRoot",type:"bytes32"}],name:"SetMerkleRoots",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"mintAmount",type:"uint256"}],name:"SetMinSwapAmount",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"address",name:"recipient",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Sweep",type:"event"},{inputs:[{internalType:"uint256",name:"_index",type:"uint256"},{internalType:"address",name:"_account",type:"address"},{internalType:"uint256",name:"_amountAllowedToClaim",type:"uint256"},{internalType:"bytes32[]",name:"_merkleProof",type:"bytes32[]"}],name:"claim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"claimed",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"merkleRoot",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"minAmountToClaim",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"_merkleRoot",type:"bytes32"}],name:"setMerkleRoots",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_minAmount",type:"uint256"}],name:"setMinSwapAmount",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"address",name:"_recepient",type:"address"}],name:"sweep",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"token",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}];function q(){var T,v;const{isConnected:c,address:m}=S(),b={address:"0xDd93D6F1C6cD253887b8335E80B984d554bE0BB6",abi:j},f={address:"0x3D3e182B6b8683FF2ceE67D5faA596ce1457023A",abi:j},[n,x]=s.useState(0),[i,g]=s.useState(0),o=K("juice"),l=K("xjuice"),{data:r}=U({contracts:[{...b,functionName:"claimed",args:[m]},{...f,functionName:"claimed",args:[m]}],watch:!0});s.useEffect(()=>{if(o&&o.amount!==""&&r&&r[0]&&r[0].result!=null){let a=BigInt(o.amount),C=BigInt(r[0].result);a>=C&&(a=a-C),x(N(a,18))}if(l&&l.amount!==""&&r&&r[1]&&r[1].result!=null){let a=BigInt(l.amount),C=BigInt(r[1].result);a>=C&&(a=a-C),g(N(a,18))}},[r,o,l,m]);const[d,w]=s.useState(!1),u=O({address:"0xDd93D6F1C6cD253887b8335E80B984d554bE0BB6",abi:j,functionName:"claim"}),M=E({hash:(T=u.data)==null?void 0:T.hash}),_=async()=>{try{w(!0),u.write({args:[o.index,m,o.amount,o.proof]})}catch(a){console.error("handleClaimFromJuice error",a),t.error("Failed to claim BLOCK from JUICE",{id:"claim-juice"})}};s.useEffect(()=>{u.isLoading&&t.loading("Claiming BLOCK, please confirm the transaction...",{id:"claim-juice"}),u.isSuccess&&d&&t.loading("Claiming BLOCK from JUICE...",{id:"claim-juice"}),u.isError&&d&&(t.error("Please try again later",{id:"claim-juice"}),w(!1)),M.isSuccess&&d&&(t.success("Successfully claimed BLOCK from JUICE!",{id:"claim-juice"}),w(!1))},[u]);const[p,B]=s.useState(!1),y=O({address:"0x3D3e182B6b8683FF2ceE67D5faA596ce1457023A",abi:j,functionName:"claim"}),A=E({hash:(v=y.data)==null?void 0:v.hash}),D=async()=>{try{B(!0),t.loading("Claiming BLOCK from xJUICE...",{id:"claim-xjuice"}),y.write({args:[l.index,m,l.amount,l.proof]})}catch(a){console.error("handleClaimFromJuice error",a),t.error("Failed to claim BLOCK from xJUICE",{id:"claim-xjuice"})}};return s.useEffect(()=>{y.isLoading&&t.loading("Claiming BLOCK, please confirm the transaction...",{id:"claim-xjuice"}),y.isSuccess&&p&&t.loading("Claiming BLOCK from xJUICE...",{id:"claim-xjuice"}),y.isError&&p&&(t.error("Please try again later",{id:"claim-xjuice"}),B(!1)),A.isSuccess&&p&&(t.success("Successfully claimed BLOCK from xJUICE!",{id:"claim-xjuice"}),B(!1))},[y]),e.jsx(R,{title:"Claim",children:e.jsx("div",{className:"container max-w-5xl mx-auto px-2 lg:px-8 pb-[10rem] lg:mt-[10rem]",children:e.jsxs("div",{className:"grid grid-cols-12 gap-[2rem]",children:[e.jsx(J,{type:"fadeInUp",className:"col-span-12 md:col-span-6",children:e.jsxs("div",{className:"card-fx glass-blur bg-gradient-to-br from-primary-700/30 to-background-400/40 p-4 rounded-lg border-primary",children:[e.jsx("div",{className:"font-semibold text-xl",children:"Claim BLOCK"}),e.jsx("div",{className:"text-sm opacity-40",children:"Claim BLOCK from your JUICE"}),e.jsx(k,{className:"my-4"}),c?e.jsxs("div",{children:[e.jsx("div",{className:"opacity-40",children:"Available to claim"}),e.jsx(I,{isLoaded:n!==null,className:"rounded-lg w-fit",children:e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx("img",{src:h.icon,alt:h.symbol,className:"w-5 h-5"}),e.jsxs("div",{className:"font-semibold text-2xl",children:[n!==null&&n!=0?F(n):"0"," BLOCK"]})]})})]}):e.jsx("div",{className:"text-center opacity-40 py-4",children:"Connect your wallet first to claim BLOCK"}),e.jsx(L,{onClick:_,isDisabled:!c||d||n==0,isLoading:d,color:"primary",className:"mt-12 font-semibold w-full",children:d?"Claiming":"Claim"})]})}),e.jsx(J,{type:"fadeInUp",className:"col-span-12 md:col-span-6",delay:.1,children:e.jsxs("div",{className:"card-fx glass-blur bg-gradient-to-br from-secondary-700/30 to-background-400/40 p-4 rounded-lg border-secondary",children:[e.jsx("div",{className:"font-semibold text-xl",children:"Claim BLOCK from xJUICE"}),e.jsx("div",{className:"text-sm opacity-40",children:"Claim BLOCK from your JUICE staking"}),e.jsx(k,{className:"my-4"}),c?e.jsxs("div",{children:[e.jsx("div",{className:"opacity-40",children:"Available to claim"}),e.jsx(I,{isLoaded:i!==null,className:"rounded-lg w-fit",children:e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx("img",{src:h.icon,alt:h.symbol,className:"w-5 h-5"}),e.jsxs("div",{className:"font-semibold text-2xl",children:[i!==null&&i!=0?F(i):"0"," BLOCK"]})]})})]}):e.jsx("div",{className:"text-center opacity-40 py-4",children:"Connect your wallet first to claim BLOCK"}),e.jsx(L,{onClick:D,isDisabled:!c||p||i==0,isLoading:p,color:"secondary",className:"mt-12 font-semibold w-full",children:p?"Claiming":"Claim"})]})})]})})})}export{q as default};
