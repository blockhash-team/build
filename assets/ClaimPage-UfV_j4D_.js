import{ag as s,ah as F,ai as R,aj as B,ak as O,al as J,am as t,$ as e,an as k,ao as E,ap as h,a1 as L}from"./index-A0WOzASO.js";import{P as A}from"./Page-llBNqKOt.js";import{s as I,f as K}from"./formattingUtils-xTz1V52S.js";const P=c=>{const[d,b]=s.useState({index:0,amount:"",proof:[]}),{isConnected:f,address:n}=F();let x="",i="";c=="juice"?(x="testnet-juice",i="https://juice.blockhashgg.workers.dev"):c=="xjuice"&&(x="testnet-juice",i="https://xjuice.blockhashgg.workers.dev");const g=s.useCallback(async()=>{if(f)try{const l=await(await fetch(i,{body:JSON.stringify({key:`${x}:${n}`}),headers:{"Content-Type":"application/json","Referrer-Policy":"no-referrer"},method:"POST"})).json();b(l)}catch{b({index:0,amount:"0",proof:[]})}},[f,n]);return s.useEffect(()=>{g()},[f,n,g]),d},S=P,j=[{inputs:[{internalType:"address",name:"token_",type:"address"},{internalType:"bytes32",name:"merkleRoot_",type:"bytes32"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Claimed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"merkleRoot",type:"bytes32"}],name:"SetMerkleRoots",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"mintAmount",type:"uint256"}],name:"SetMinSwapAmount",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"address",name:"recipient",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Sweep",type:"event"},{inputs:[{internalType:"uint256",name:"_index",type:"uint256"},{internalType:"address",name:"_account",type:"address"},{internalType:"uint256",name:"_amountAllowedToClaim",type:"uint256"},{internalType:"bytes32[]",name:"_merkleProof",type:"bytes32[]"}],name:"claim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"claimed",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"merkleRoot",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"minAmountToClaim",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"_merkleRoot",type:"bytes32"}],name:"setMerkleRoots",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_minAmount",type:"uint256"}],name:"setMinSwapAmount",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"address",name:"_recepient",type:"address"}],name:"sweep",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"token",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}];function q(){var v,N;const{isConnected:c,address:d}=F(),b={address:"0x15087888cEE1D2b8d68259a4436526C87c48dfb6",abi:j},f={address:"0xB6329641c0814DF4248F71DD07995087d4b80622",abi:j},[n,x]=s.useState(0),[i,g]=s.useState(0),o=S("juice"),l=S("xjuice"),{data:r}=R({contracts:[{...b,functionName:"claimed",args:[d]},{...f,functionName:"claimed",args:[d]}],watch:!0});s.useEffect(()=>{if(o&&o.amount!==""&&r&&r[0]&&r[0].result!=null){let a=BigInt(o.amount),C=BigInt(r[0].result);a>=C&&(a=a-C),x(B(a,18))}if(l&&l.amount!==""&&r&&r[1]&&r[1].result!=null){let a=BigInt(l.amount),C=BigInt(r[1].result);a>=C&&(a=a-C),g(B(a,18))}},[r,o,l,d]);const[m,w]=s.useState(!1),u=O({address:"0x15087888cEE1D2b8d68259a4436526C87c48dfb6",abi:j,functionName:"claim"}),M=J({hash:(v=u.data)==null?void 0:v.hash}),_=async()=>{try{w(!0),u.write({args:[o.index,d,o.amount,o.proof]})}catch(a){console.error("handleClaimFromJuice error",a),t.error("Failed to claim BLOCK from JUICE",{id:"claim-juice"})}};s.useEffect(()=>{u.isLoading&&t.loading("Claiming BLOCK, please confirm the transaction...",{id:"claim-juice"}),u.isSuccess&&m&&t.loading("Claiming BLOCK from JUICE...",{id:"claim-juice"}),u.isError&&m&&(t.error("Please try again later",{id:"claim-juice"}),w(!1)),M.isSuccess&&m&&(t.success("Successfully claimed BLOCK from JUICE!",{id:"claim-juice"}),w(!1))},[u]);const[p,T]=s.useState(!1),y=O({address:"0xB6329641c0814DF4248F71DD07995087d4b80622",abi:j,functionName:"claim"}),U=J({hash:(N=y.data)==null?void 0:N.hash}),D=async()=>{try{T(!0),t.loading("Claiming BLOCK from xJUICE...",{id:"claim-xjuice"}),y.write({args:[l.index,d,l.amount,l.proof]})}catch(a){console.error("handleClaimFromJuice error",a),t.error("Failed to claim BLOCK from xJUICE",{id:"claim-xjuice"})}};return s.useEffect(()=>{y.isLoading&&t.loading("Claiming BLOCK, please confirm the transaction...",{id:"claim-xjuice"}),y.isSuccess&&p&&t.loading("Claiming BLOCK from xJUICE...",{id:"claim-xjuice"}),y.isError&&p&&(t.error("Please try again later",{id:"claim-xjuice"}),T(!1)),U.isSuccess&&p&&(t.success("Successfully claimed BLOCK from xJUICE!",{id:"claim-xjuice"}),T(!1))},[y]),e.jsx(A,{title:"Claim",children:e.jsx("div",{className:"container max-w-5xl mx-auto px-2 lg:px-8 pb-[10rem] lg:mt-[10rem]",children:e.jsxs("div",{className:"grid grid-cols-12 gap-[2rem]",children:[e.jsx(k,{type:"fadeInUp",className:"col-span-12 md:col-span-6",children:e.jsxs("div",{className:"card-fx glass-blur bg-gradient-to-br from-primary-700/30 to-background-400/40 p-4 rounded-lg border-primary",children:[e.jsx("div",{className:"font-semibold text-xl",children:"Claim BLOCK"}),e.jsx("div",{className:"text-sm opacity-40",children:"Claim BLOCK from your JUICE"}),e.jsx(E,{className:"my-4"}),c?e.jsxs("div",{children:[e.jsx("div",{className:"opacity-40",children:"Available to claim"}),e.jsx(I,{isLoaded:n!==null,className:"rounded-lg w-fit",children:e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx("img",{src:h.icon,alt:h.symbol,className:"w-5 h-5"}),e.jsxs("div",{className:"font-semibold text-2xl",children:[n!==null&&n!=0?K(n):"0"," BLOCK"]})]})})]}):e.jsx("div",{className:"text-center opacity-40 py-4",children:"Connect your wallet first to claim BLOCK"}),e.jsx(L,{onClick:_,isDisabled:!c||m||n==0,isLoading:m,color:"primary",className:"mt-12 font-semibold w-full",children:m?"Claiming":"Claim"})]})}),e.jsx(k,{type:"fadeInUp",className:"col-span-12 md:col-span-6",delay:.1,children:e.jsxs("div",{className:"card-fx glass-blur bg-gradient-to-br from-secondary-700/30 to-background-400/40 p-4 rounded-lg border-secondary",children:[e.jsx("div",{className:"font-semibold text-xl",children:"Claim BLOCK from xJUICE"}),e.jsx("div",{className:"text-sm opacity-40",children:"Claim BLOCK from your JUICE staking"}),e.jsx(E,{className:"my-4"}),c?e.jsxs("div",{children:[e.jsx("div",{className:"opacity-40",children:"Available to claim"}),e.jsx(I,{isLoaded:i!==null,className:"rounded-lg w-fit",children:e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx("img",{src:h.icon,alt:h.symbol,className:"w-5 h-5"}),e.jsxs("div",{className:"font-semibold text-2xl",children:[i!==null&&i!=0?K(i):"0"," BLOCK"]})]})})]}):e.jsx("div",{className:"text-center opacity-40 py-4",children:"Connect your wallet first to claim BLOCK"}),e.jsx(L,{onClick:D,isDisabled:!c||p||i==0,isLoading:p,color:"secondary",className:"mt-12 font-semibold w-full",children:p?"Claiming":"Claim"})]})})]})})})}export{q as default};
